#!/bin/bash
set -e

command="$1"
case "${command}" in
    deps)
        glide install
        ;;
    build)
        rm -rf bin/dojo
        (set -x; CGO_ENABLED=0 go install ./; )
        ;;
    unit)
        (set -x; go test -v -race ./...; )
        ;;
    e2e)
        (set -x; bats ./test; )
        ;;
    test_signals)
        (set -x; ./test/signal/signals-tests.sh; )
        ;;
    *)
        echo "Invalid command: '${command}'"
        exit 1
        ;;
esac
set +e
